{"version":3,"sources":["components/Button.tsx","components/Place.tsx","containers/Welcome/index.tsx","assets/cross.svg","assets/tick.svg","assets/checkbox.svg","assets/checkboxChecked.svg","utils/zeroPadding.ts","assets/crossBlack.svg","assets/greenTick.svg","containers/Confirm/AutoLeaveModal.tsx","containers/Confirm/LeaveModal.tsx","components/DatePicker.tsx","containers/Confirm/TimePickModal.tsx","containers/Confirm/index.tsx","assets/back.svg","assets/qrOverlay.svg","components/QRCodeReader.tsx","containers/QR/index.tsx","utils/qrDecode.ts","assets/plus.svg","components/PWAPrompt.tsx","App.tsx","serviceWorkerRegistration.ts","index.tsx"],"names":["ConfirmButton","styled","button","props","disabled","shadowed","ModalConfirmButton","Place","input","Welcome","useState","place","setPlace","PageWrapper","ContentWrapper","Msg","value","onChange","e","target","placeholder","ActionWrapper","to","pathname","search","StyledLink","div","Link","zeroPadding","String","slice","AutoLeaveModal","isModalOpen","onCancel","onConfirm","selectedAutoLeaveHour","date","autoLeaveHourTmp","setAutoLeaveHourTmp","useEffect","useMemo","toDate","Date","setHours","getHours","fromMonth","getMonth","fromDay","getDate","fromHour","fromMinute","getMinutes","toMonth","toDay","toHour","toMinute","isOpen","onRequestClose","style","overlay","backgroundColor","content","outline","border","padding","borderRadius","width","position","top","left","transform","height","overflow","ariaHideApp","onAfterOpen","root","document","querySelector","disableBodyScroll","CrossWrapper","Cross","src","crossBlack","onClick","Title","HourListWrapper","id","HourList","map","hour","HourListItem","SelectedTick","greenTick","TimeWrapper","img","h1","ul","li","LeaveModal","onLeaveNow","onLeaved","GreenButton","DatePicker","forwardRef","ref","useImperativeHandle","init","ele","Picker","inline","rows","Wrapper","className","TimePickModal","datePickerRef","useRef","current","TimePickerWrapper","Confirm","browserHistory","useHistory","browserLocation","useLocation","autoLeave","setAutoLeave","autoLeaveHour","setAutoLeaveHour","isAutoLeaveModalOpen","setIsAutoLeaveModalOpen","isLeaveModalOpen","setIsLeaveModalOpen","isTimePickModalOpen","setIsTimePickModalOpen","URLSearchParams","get","push","year","getFullYear","month","day","minute","handleLeavePage","Header","cross","readOnly","Time","TickWrapper","TickWrapperInner","Tick","tick","AutoLeave","CheckBoxWrapper","CheckBox","checkboxChecked","checkbox","prev","Change","LeaveMessage","getUserMedia","constraints","navigator","mediaDevices","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","Promise","resolve","reject","call","Error","QRCodeReader","onDecode","videoRef","canvasRef","useCallback","canvasElement","videoElement","readyState","HAVE_ENOUGH_DATA","canvas","getContext","videoHeight","videoWidth","drawImage","imageData","getImageData","code","jsQR","data","inversionAttempts","requestAnimationFrame","video","facingMode","then","stream","srcObject","play","Video","playsInline","Canvas","QR","BackButton","back","Overlay","Message","VideoContainer","startsWith","json","JSON","parse","window","atob","substring","console","log","name","nameZh","nameEn","decodeURIComponent","escape","qrDecode","qrOverlay","PWAPrompt","AddIcon","plus","InstructionWrapper","App","isPWA","setPWA","matchMedia","matches","test","location","hash","hostname","GlobalStyle","basename","exact","path","createGlobalStyle","isLocalhost","Boolean","match","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","onUpdate","onSuccess","catch","error","ReactDOM","render","StrictMode","getElementById","URL","process","href","origin","addEventListener","fetch","headers","response","contentType","status","indexOf","ready","unregister","reload","checkValidServiceWorker","serviceWorkerRegistration"],"mappings":"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","file":"static/js/main.a3b61b1b.chunk.js","sourcesContent":["import styled from \"styled-components\";\n\nexport const ConfirmButton = styled.button<{ shadowed?: boolean }>`\n  display: block;\n  margin: auto;\n  margin-bottom: 16px;\n  font-size: 24px;\n  padding: 10px 0;\n  width: 80%;\n  border-radius: 48px;\n  ${(props) =>\n    props.disabled\n      ? `background-color: #D3D3D3;\n        color: #A1A1A1;\n        `\n      : `\n        background-color: #fed426;\n      `}\n\n  border: 0;\n  outline: none;\n  ${(props) =>\n    props.shadowed ? \"box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.5);\" : \"\"}\n\n  &:focus {\n    outline: none;\n    text-decoration: none;\n  }\n`;\n\nexport const ModalConfirmButton = styled(ConfirmButton)`\n  font-size: 16px;\n  padding: 12px 0;\n  width: 90%;\n`;\n","import styled from \"styled-components\";\n\nexport const Place = styled.input`\n  text-align: center;\n  font-size: 32px;\n  background-color: transparent;\n  border: 0;\n  outline: none;\n  margin: 8px 0;\n  color: #fed426;\n  text-shadow: 0px 1px 2px rgba(0, 0, 0, 0.8);\n\n  &:focus {\n    outline: none;\n  }\n`;\n","import React, { useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport { ConfirmButton } from \"../../components/Button\";\nimport { Place } from \"../../components/Place\";\n\nexport const Welcome = () => {\n  const [place, setPlace] = useState(\"\");\n\n  return (\n    <PageWrapper>\n      <ContentWrapper>\n        <Msg>我想去</Msg>\n        <Place\n          value={place}\n          onChange={(e) => setPlace(e.target.value)}\n          placeholder=\"輸入地址\"\n        />\n      </ContentWrapper>\n      <ActionWrapper>\n        {place === \"\" ? (\n          <ConfirmButton disabled shadowed>\n            話去就去!\n          </ConfirmButton>\n        ) : (\n          <Link to={{ pathname: \"/confirm\", search: `?place=${place}` }}>\n            <ConfirmButton shadowed>話去就去!</ConfirmButton>\n          </Link>\n        )}\n        <StyledLink to=\"/qr\">掃瞄二維碼</StyledLink>\n      </ActionWrapper>\n    </PageWrapper>\n  );\n};\n\nconst PageWrapper = styled.div`\n  width: 100%;\n  height: 100%;\n  text-shadow: 0px 1px 2px rgba(0, 0, 0, 0.8);\n`;\n\nconst ContentWrapper = styled.div`\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  flex-direction: column;\n`;\n\nconst Msg = styled.div`\n  color: #ffffff;\n  text-align: center;\n  font-size: 15px;\n`;\n\nconst ActionWrapper = styled.div`\n  width: 100%;\n  position: absolute;\n  bottom: 0;\n  text-align: center;\n  color: #fff;\n  padding-bottom: 40px;\n`;\n\nconst StyledLink = styled(Link)`\n  color: #ffffff;\n`;\n","export default __webpack_public_path__ + \"static/media/cross.d2bbc7f7.svg\";","export default __webpack_public_path__ + \"static/media/tick.6d45b966.svg\";","export default __webpack_public_path__ + \"static/media/checkbox.7f6c2da0.svg\";","export default __webpack_public_path__ + \"static/media/checkboxChecked.dad8859a.svg\";","export const zeroPadding = (input: string | number) =>\n  (\"00\" + String(input)).slice(-2);\n","export default __webpack_public_path__ + \"static/media/crossBlack.aafc0aee.svg\";","export default __webpack_public_path__ + \"static/media/greenTick.5e528318.svg\";","import React, { useState, useEffect, useMemo } from \"react\";\nimport Modal from \"react-modal\";\nimport crossBlack from \"../../assets/crossBlack.svg\";\nimport greenTick from \"../../assets/greenTick.svg\";\n\nimport styled from \"styled-components\";\nimport { ModalConfirmButton } from \"../../components/Button\";\nimport { zeroPadding } from \"../../utils/zeroPadding\";\nimport { disableBodyScroll } from \"body-scroll-lock\";\n\ntype Props = {\n  isModalOpen: boolean;\n  onCancel: () => void;\n  onConfirm: (value: number) => void;\n  selectedAutoLeaveHour: number;\n  date: Date;\n};\n\nexport const AutoLeaveModal = ({\n  isModalOpen,\n  onCancel,\n  onConfirm,\n  selectedAutoLeaveHour,\n  date,\n}: Props) => {\n  const [autoLeaveHourTmp, setAutoLeaveHourTmp] = useState(\n    selectedAutoLeaveHour\n  );\n\n  useEffect(() => {\n    setAutoLeaveHourTmp(selectedAutoLeaveHour);\n  }, [setAutoLeaveHourTmp, selectedAutoLeaveHour]);\n\n  const handleConfirm = () => {\n    onConfirm(autoLeaveHourTmp);\n  };\n\n  const {\n    fromMonth,\n    fromDay,\n    fromHour,\n    fromMinute,\n    toMonth,\n    toDay,\n    toHour,\n    toMinute,\n  } = useMemo(() => {\n    const toDate = new Date(date);\n    toDate.setHours(date.getHours() + autoLeaveHourTmp);\n\n    return {\n      fromMonth: date.getMonth() + 1,\n      fromDay: date.getDate(),\n      fromHour: date.getHours(),\n      fromMinute: date.getMinutes(),\n\n      toMonth: toDate.getMonth() + 1,\n      toDay: toDate.getDate(),\n      toHour: toDate.getHours(),\n      toMinute: toDate.getMinutes(),\n    };\n  }, [date, autoLeaveHourTmp]);\n\n  const disableScroll = () => {\n    const root = document.querySelector(\"#scroll\");\n    if (!root) return;\n    disableBodyScroll(root);\n  };\n\n  return (\n    <Modal\n      isOpen={isModalOpen}\n      onRequestClose={onCancel}\n      style={{\n        overlay: {\n          backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n        },\n        content: {\n          outline: \"none\",\n          border: \"0\",\n          padding: \"16px\",\n          borderRadius: \"8px\",\n          width: \"240px\",\n          position: \"absolute\",\n          top: \"50%\",\n          left: \"50%\",\n          transform: \"translate(-50%, -50%)\",\n          height: \"370px\",\n          overflow: \"hidden\",\n        },\n      }}\n      ariaHideApp={false}\n      onAfterOpen={disableScroll}\n    >\n      <CrossWrapper>\n        <Cross src={crossBlack} onClick={onCancel} />\n      </CrossWrapper>\n      <Title>設罝自動離開時間</Title>\n      <HourListWrapper id=\"scroll\">\n        <HourList>\n          {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map((hour) => (\n            <HourListItem\n              onClick={() => {\n                setAutoLeaveHourTmp(hour);\n              }}\n            >\n              + {hour}小時\n              {autoLeaveHourTmp === hour && <SelectedTick src={greenTick} />}\n            </HourListItem>\n          ))}\n        </HourList>\n      </HourListWrapper>\n      <TimeWrapper>\n        <div>\n          於{zeroPadding(fromMonth)}-{zeroPadding(fromDay)}{\" \"}\n          {zeroPadding(fromHour)}:{zeroPadding(fromMinute)} 進入場所\n        </div>\n        <div>\n          於{zeroPadding(toMonth)}-{zeroPadding(toDay)} {zeroPadding(toHour)}:\n          {zeroPadding(toMinute)} 自動離開\n        </div>\n      </TimeWrapper>\n      <ModalConfirmButton onClick={handleConfirm}>確認</ModalConfirmButton>\n    </Modal>\n  );\n};\n\nconst Cross = styled.img`\n  height: 20px;\n`;\n\nconst CrossWrapper = styled.div`\n  display: flex;\n  width: 100%;\n  justify-content: flex-end;\n`;\n\nconst Title = styled.h1`\n  font-size: 20px;\n  text-align: center;\n  margin-top: 20px;\n  margin-bottom: 0;\n`;\n\nconst HourListWrapper = styled.div`\n  overflow: auto;\n  height: 180px;\n  padding: 0 8px;\n`;\n\nconst HourList = styled.ul`\n  list-style: none;\n  margin: 0;\n  padding: 0;\n`;\n\nconst HourListItem = styled.li`\n  line-height: 40px;\n  border-bottom: 1px #eeeeee solid;\n  padding: 0 8px;\n`;\n\nconst TimeWrapper = styled.div`\n  font-size: 12px;\n  text-align: center;\n  padding: 16px 0;\n`;\n\nconst SelectedTick = styled.img`\n  height: 32px;\n  position: relative;\n  float: right;\n  top: 4px;\n`;\n","import React from \"react\";\nimport Modal from \"react-modal\";\nimport crossBlack from \"../../assets/crossBlack.svg\";\n\nimport styled from \"styled-components\";\nimport { ModalConfirmButton } from \"../../components/Button\";\n\ntype Props = {\n  isModalOpen: boolean;\n  onCancel: () => void;\n  onLeaveNow: () => void;\n  onLeaved: () => void;\n};\n\nexport const LeaveModal = ({\n  isModalOpen,\n  onCancel,\n  onLeaveNow,\n  onLeaved,\n}: Props) => {\n  return (\n    <Modal\n      isOpen={isModalOpen}\n      onRequestClose={onCancel}\n      style={{\n        overlay: {\n          backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n        },\n        content: {\n          outline: \"none\",\n          border: \"0\",\n          padding: \"16px\",\n          borderRadius: \"8px\",\n          width: \"240px\",\n          position: \"absolute\",\n          top: \"50%\",\n          left: \"50%\",\n          transform: \"translate(-50%, -50%)\",\n          height: \"280px\",\n          overflow: \"hidden\",\n        },\n      }}\n      ariaHideApp={false}\n    >\n      <CrossWrapper>\n        <Cross src={crossBlack} onClick={onCancel} />\n      </CrossWrapper>\n      <Title>你現在要離開嗎？</Title>\n      <ModalConfirmButton onClick={onLeaveNow}>\n        是的，我現在要離開\n      </ModalConfirmButton>\n      <GreenButton onClick={onLeaved}>我現已經離開了</GreenButton>\n    </Modal>\n  );\n};\n\nconst Cross = styled.img`\n  height: 20px;\n`;\n\nconst CrossWrapper = styled.div`\n  display: flex;\n  width: 100%;\n  justify-content: flex-end;\n`;\n\nconst Title = styled.div`\n  font-size: 20px;\n  text-align: center;\n  margin: 56px 0;\n`;\n\nconst GreenButton = styled(ModalConfirmButton)`\n  background-color: #12b188;\n  color: #fff;\n`;\n","import React, { forwardRef, useImperativeHandle } from \"react\";\n\nimport styled from \"styled-components\";\nimport Picker from \"pickerjs\";\nimport \"pickerjs/dist/picker.min.css\";\n\nexport type DatePickerHandler = {\n  init: () => void;\n};\n\nexport const DatePicker = forwardRef((props: any, ref: any) => {\n  // mount effect wont work on model, need to call this after onAfterOpen event\n  useImperativeHandle(ref, () => ({\n    init: () => {\n      const ele = document.querySelector(\n        \".js-inline-picker\"\n      ) as HTMLElement | null;\n      if (!ele) return;\n      new Picker(ele, {\n        inline: true,\n        rows: 2,\n      });\n    },\n  }));\n\n  return (\n    <Wrapper>\n      <div className=\"js-inline-picker\" />\n    </Wrapper>\n  );\n});\n\nconst Wrapper = styled.div`\n  & .picker {\n    font-size: 12px;\n  }\n\n  & .picker-dialog {\n    border: 0;\n  }\n\n  & .picker-cell:before {\n    background-image: unset;\n  }\n\n  & .picker-cell:after {\n    background-image: unset;\n  }\n\n  & .picker-picked {\n    color: unset;\n    border-top: #12b188 1px solid;\n    border-bottom: #12b188 1px solid;\n  }\n\n  & .picker-cell {\n    padding: 0 4px;\n  }\n\n  & .picker-item {\n    padding: 3px 0px;\n  }\n\n  & .picker-cell + .picker-cell {\n    border: 0;\n  }\n`;\n","import React, { useRef } from \"react\";\nimport Modal from \"react-modal\";\nimport crossBlack from \"../../assets/crossBlack.svg\";\n\nimport styled from \"styled-components\";\nimport { ModalConfirmButton } from \"../../components/Button\";\nimport { DatePicker, DatePickerHandler } from \"../../components/DatePicker\";\n\ntype Props = {\n  isModalOpen: boolean;\n  onCancel: () => void;\n  onConfirm: () => void;\n};\n\nexport const TimePickModal = ({ isModalOpen, onCancel, onConfirm }: Props) => {\n  const datePickerRef = useRef<DatePickerHandler>(null);\n\n  const initPicker = () => {\n    datePickerRef.current && datePickerRef.current.init();\n  };\n\n  return (\n    <Modal\n      isOpen={isModalOpen}\n      onRequestClose={onCancel}\n      style={{\n        overlay: {\n          backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n        },\n        content: {\n          outline: \"none\",\n          border: \"0\",\n          padding: \"16px\",\n          borderRadius: \"8px\",\n          width: \"240px\",\n          position: \"absolute\",\n          top: \"50%\",\n          left: \"50%\",\n          transform: \"translate(-50%, -50%)\",\n          height: \"280px\",\n          overflow: \"hidden\",\n        },\n      }}\n      ariaHideApp={false}\n      onAfterOpen={initPicker}\n    >\n      <CrossWrapper>\n        <Cross src={crossBlack} onClick={onCancel} />\n      </CrossWrapper>\n      <Title>你是什麼時候離開？</Title>\n      <TimePickerWrapper>\n        <DatePicker ref={datePickerRef} />\n      </TimePickerWrapper>\n      <ModalConfirmButton onClick={onConfirm}>確認</ModalConfirmButton>\n    </Modal>\n  );\n};\n\nconst Cross = styled.img`\n  height: 20px;\n`;\n\nconst CrossWrapper = styled.div`\n  display: flex;\n  width: 100%;\n  justify-content: flex-end;\n`;\n\nconst Title = styled.div`\n  font-size: 20px;\n  text-align: center;\n  margin-top: 24px;\n`;\n\nconst TimePickerWrapper = styled.div`\n  border-bottom: 1px #eeeeee solid;\n  border-top: 1px #eeeeee solid;\n  padding: 32px 0;\n  margin: 16px 0;\n`;\n","import React, { useEffect, useMemo, useState } from \"react\";\nimport styled from \"styled-components\";\nimport cross from \"../../assets/cross.svg\";\n\nimport tick from \"../../assets/tick.svg\";\nimport checkbox from \"../../assets/checkbox.svg\";\nimport checkboxChecked from \"../../assets/checkboxChecked.svg\";\n\nimport { Link, useHistory, useLocation } from \"react-router-dom\";\nimport { ConfirmButton } from \"../../components/Button\";\nimport { zeroPadding } from \"../../utils/zeroPadding\";\nimport { Place } from \"../../components/Place\";\nimport { AutoLeaveModal } from \"./AutoLeaveModal\";\nimport { LeaveModal } from \"./LeaveModal\";\nimport { TimePickModal } from \"./TimePickModal\";\n\nexport const Confirm = () => {\n  const browserHistory = useHistory();\n  const browserLocation = useLocation();\n  const [autoLeave, setAutoLeave] = useState(false);\n  const [autoLeaveHour, setAutoLeaveHour] = useState(4);\n  const [isAutoLeaveModalOpen, setIsAutoLeaveModalOpen] = useState(false);\n  const [isLeaveModalOpen, setIsLeaveModalOpen] = useState(false);\n  const [isTimePickModalOpen, setIsTimePickModalOpen] = useState(false);\n\n  const place = useMemo(\n    () => new URLSearchParams(browserLocation.search).get(\"place\"),\n    [browserLocation.search]\n  );\n\n  useEffect(() => {\n    if (!place || place === \"\") browserHistory.push(\"/\");\n  }, [browserHistory, place]);\n\n  const { date, year, month, day, hour, minute } = useMemo(() => {\n    const date = new Date();\n    return {\n      date,\n      year: date.getFullYear(),\n      month: date.getMonth() + 1,\n      day: date.getDate(),\n      hour: date.getHours(),\n      minute: date.getMinutes(),\n    };\n  }, []);\n\n  const handleCheckBoxClick = () => {\n    setAutoLeave((prev) => !prev);\n  };\n\n  const handleSetAutoLeaveHour = (value: number) => {\n    setAutoLeaveHour(value);\n    setIsAutoLeaveModalOpen(false);\n  };\n\n  const handleLeavePage = () => {\n    browserHistory.push(\"/\");\n  };\n\n  const handleLeaved = () => {\n    setIsLeaveModalOpen(false);\n    setIsTimePickModalOpen(true);\n  };\n\n  return (\n    <PageWrapper>\n      <Header>\n        <Link to=\"/\">\n          <Cross src={cross} />\n        </Link>\n      </Header>\n      <Msg>你已進入場所</Msg>\n      {place && <Place value={place} readOnly />}\n      <Time>{`${year}-${zeroPadding(month)}-${zeroPadding(day)} ${zeroPadding(\n        hour\n      )}:${zeroPadding(minute)}`}</Time>\n      <TickWrapper>\n        <TickWrapperInner>\n          <Tick src={tick} />\n        </TickWrapperInner>\n      </TickWrapper>\n      <AutoLeave>\n        <CheckBoxWrapper>\n          <CheckBox\n            src={autoLeave ? checkboxChecked : checkbox}\n            onClick={handleCheckBoxClick}\n          />\n          {autoLeaveHour}小時後自動離開\n        </CheckBoxWrapper>\n        <Change\n          onClick={() => {\n            setIsAutoLeaveModalOpen(true);\n          }}\n        >\n          變更\n        </Change>\n      </AutoLeave>\n      <ConfirmButton\n        shadowed\n        onClick={() => {\n          setIsLeaveModalOpen(true);\n        }}\n      >\n        離開\n      </ConfirmButton>\n      <LeaveMessage>當你離開時請緊記按\"離開\"</LeaveMessage>\n      <AutoLeaveModal\n        isModalOpen={isAutoLeaveModalOpen}\n        onCancel={() => {\n          setIsAutoLeaveModalOpen(false);\n        }}\n        onConfirm={handleSetAutoLeaveHour}\n        selectedAutoLeaveHour={autoLeaveHour}\n        date={date}\n      />\n      <LeaveModal\n        isModalOpen={isLeaveModalOpen}\n        onCancel={() => {\n          setIsLeaveModalOpen(false);\n        }}\n        onLeaveNow={handleLeavePage}\n        onLeaved={handleLeaved}\n      />\n      <TimePickModal\n        isModalOpen={isTimePickModalOpen}\n        onCancel={() => {\n          setIsTimePickModalOpen(false);\n        }}\n        onConfirm={handleLeavePage}\n      />\n    </PageWrapper>\n  );\n};\n\nconst PageWrapper = styled.div`\n  width: 100%;\n  height: 100%;\n  text-shadow: 0px 1px 2px rgba(0, 0, 0, 0.8);\n  display: flex;\n  flex-direction: column;\n  color: #fff;\n`;\n\nconst Header = styled.div`\n  width: 100%;\n  display: flex;\n  justify-content: flex-end;\n  flex-shrink: 0;\n`;\n\nconst Cross = styled.img`\n  height: 20px;\n  margin: 24px;\n`;\n\nconst TickWrapper = styled.div`\n  height: 100%;\n  width: 100%;\n  text-align: center;\n`;\n\nconst TickWrapperInner = styled.div`\n  height: 100%;\n  max-height: 280px;\n  display: flex;\n  justify-content: center;\n  flex-direction: column;\n`;\n\nconst Tick = styled.img`\n  display: inline-block;\n  height: 100%;\n  max-height: 120px;\n`;\n\nconst Msg = styled.div`\n  color: #ffffff;\n  text-align: center;\n  font-size: 15px;\n  margin-top: 50px;\n`;\n\nconst Time = styled.div`\n  color: #ffffff;\n  text-align: center;\n`;\n\nconst AutoLeave = styled.div`\n  margin-bottom: 16px;\n  width: 100%;\n  display: flex;\n`;\n\nconst CheckBoxWrapper = styled.div`\n  width: 100%;\n  text-align: left;\n  padding-left: 24px;\n  line-height: 32px;\n`;\n\nconst Change = styled.div`\n  flex-shrink: 0;\n  padding-right: 24px;\n  line-height: 32px;\n`;\n\nconst CheckBox = styled.img`\n  height: 32px;\n  display: inline-block;\n  vertical-align: top;\n  margin-right: 8px;\n`;\n\nconst LeaveMessage = styled.div`\n  text-align: center;\n  padding-bottom: 40px;\n`;\n","export default __webpack_public_path__ + \"static/media/back.7bf7a56f.svg\";","export default __webpack_public_path__ + \"static/media/qrOverlay.185cc3ea.svg\";","import React, { useCallback, useEffect, useRef } from \"react\";\nimport jsQR, { QRCode } from \"jsqr\";\nimport styled from \"styled-components\";\n\ntype Props = {\n  onDecode: (code: QRCode) => void;\n};\n\n// ref: https://ithelp.ithome.com.tw/articles/10239258\nconst OldGetUserMedia = () =>\n  navigator.getUserMedia ||\n  (navigator as any).webkitGetUserMedia ||\n  (navigator as any).mozGetUserMedia ||\n  (navigator as any).msGetUserMedia;\n\n// Initializes media stream.\nconst getUserMedia = (constraints: MediaStreamConstraints) => {\n  if (\"mediaDevices\" in navigator) {\n    return navigator.mediaDevices.getUserMedia(constraints);\n  }\n  // 相容處理，依照新接口\n  (navigator as any).mediaDevices = {};\n\n  (navigator as any).mediaDevices.getUserMedia = (\n    constraints: MediaStreamConstraints\n  ) => {\n    const getUserMedia = OldGetUserMedia();\n\n    // 不支援的情況下\n    if (!getUserMedia) {\n      return Promise.reject(\n        new Error(\"getUserMedia is not implemented in this browser\")\n      );\n    }\n\n    // 保持跟原先api一樣故將其封裝成promise\n    return new Promise(function (resolve, reject) {\n      getUserMedia.call(navigator, constraints, resolve, reject);\n    });\n  };\n\n  return (navigator as any).mediaDevices.getUserMedia(constraints);\n};\n\nexport const QRCodeReader = ({ onDecode }: Props) => {\n  const videoRef = useRef<HTMLVideoElement>(null);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  const tick = useCallback(() => {\n    const canvasElement = canvasRef.current;\n    const videoElement = videoRef.current;\n\n    if (\n      canvasElement &&\n      videoElement &&\n      videoElement.readyState === videoElement.HAVE_ENOUGH_DATA\n    ) {\n      const canvas = canvasElement.getContext(\"2d\");\n      if (!canvas) return;\n\n      canvasElement.height = videoElement.videoHeight;\n      canvasElement.width = videoElement.videoWidth;\n      canvas.drawImage(\n        videoElement,\n        0,\n        0,\n        canvasElement.width,\n        canvasElement.height\n      );\n\n      const imageData = canvas.getImageData(\n        0,\n        0,\n        canvasElement.width,\n        canvasElement.height\n      );\n      const code = jsQR(imageData.data, imageData.width, imageData.height, {\n        inversionAttempts: \"dontInvert\",\n      });\n\n      if (code) {\n        onDecode(code);\n      }\n    }\n    requestAnimationFrame(tick);\n  }, [videoRef, canvasRef, onDecode]);\n\n  useEffect(() => {\n    const videoElement = videoRef.current;\n    if (!videoElement) return;\n\n    getUserMedia({ video: { facingMode: \"environment\" } }).then(\n      (stream: MediaStream) => {\n        if (!videoElement) return;\n        videoElement.srcObject = stream;\n        videoElement.play();\n        requestAnimationFrame(tick);\n      }\n    );\n  }, [tick, videoRef]);\n\n  return (\n    <>\n      <Video ref={videoRef} playsInline />\n      <Canvas ref={canvasRef} />\n    </>\n  );\n};\n\nconst Video = styled.video`\n  /* Make video to at least 100% wide and tall */\n  min-width: 100%;\n  min-height: 100%;\n\n  /* Setting width & height to auto prevents the browser from stretching or squishing the video */\n  width: auto;\n  height: auto;\n\n  /* Center the video */\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n`;\n\nconst Canvas = styled.canvas`\n  display: none;\n`;\n","import React from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport back from \"../../assets/back.svg\";\nimport { qrDecode } from \"../../utils/qrDecode\";\nimport qrOverlay from \"../../assets/qrOverlay.svg\";\nimport { QRCodeReader } from \"../../components/QRCodeReader\";\nimport { QRCode } from \"jsqr\";\n\nexport const QR = () => {\n  const browserHistory = useHistory();\n\n  const handleScan = ({ data }: QRCode) => {\n    if (!data || data === \"\") return;\n    const place = qrDecode(data);\n    if (place === \"\") return;\n    browserHistory.push({ pathname: \"/confirm\", search: `?place=${place}` });\n  };\n\n  return (\n    <>\n      <Header>\n        <Link to=\"/\">\n          <BackButton src={back} />\n        </Link>\n        掃瞄二維碼\n      </Header>\n      <Overlay />\n      <Message>掃瞄二維碼</Message>\n      <VideoContainer>\n        <QRCodeReader onDecode={handleScan} />\n      </VideoContainer>\n    </>\n  );\n};\n\nconst BackButton = styled.img`\n  height: 20px;\n  top: 14px;\n  left: 16px;\n  position: absolute;\n`;\n\nconst Header = styled.div`\n  width: 100%;\n  position: absolute;\n  z-index: 100;\n  color: #ffffff;\n  background-color: #12b188;\n  text-align: center;\n  line-height: 48px;\n  text-shadow: 0px 1px 2px rgba(0, 0, 0, 0.8);\n`;\n\nconst VideoContainer = styled.div`\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n`;\n\nconst Overlay = styled.div`\n  /* The image used */\n  background-image: url(\"${qrOverlay}\");\n\n  /* Full height */\n  height: 100%;\n\n  /* Center and scale the image nicely */\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: cover;\n\n  z-index: 50;\n  position: relative;\n`;\n\nconst Message = styled.div`\n  position: absolute;\n  z-index: 51;\n  bottom: 25%;\n  width: 100%;\n  text-align: center;\n  color: #ffffff;\n  font-size: 16px;\n`;\n","type DecodedJSON = {\n  hash: string;\n  metadata: { typeEn: string; typeZh: string };\n  nameEn: string;\n  nameZh: string;\n  type: string;\n};\n\n// https://github.com/aaasssdddwww/back-home-safe/pull/7\nexport const qrDecode = (input: string): string => {\n  if (!input.startsWith(\"HKEN:\")) return \"\";\n  const json: DecodedJSON = JSON.parse(window.atob(input.substring(14)));\n  console.log(json);\n  const name = json.nameZh || json.nameEn;\n\n  return decodeURIComponent(escape(name));\n};\n","export default __webpack_public_path__ + \"static/media/plus.abd4712a.svg\";","import React from \"react\";\nimport styled from \"styled-components\";\nimport plus from \"../../src/assets/plus.svg\";\n\nexport const PWAPrompt = () => {\n  return (\n    <Wrapper>\n      <AddIcon src={plus} />\n      <div>新增至主畫面先啦</div>\n      <div>唔係點似個App</div>\n      <InstructionWrapper>\n        <div>IOS</div>\n        <div>{\"用Safari開=>分享=>新增至主畫面\"}</div>\n        <div>Android</div>\n        <div>{\"用Chrome開=>右上選項=>新增至主畫面/安裝應用程式\"}</div>\n      </InstructionWrapper>\n    </Wrapper>\n  );\n};\n\nconst Wrapper = styled.div`\n  display: flex;\n  width: 100%;\n  height: 100%;\n  justify-content: center;\n  vertical-align: middle;\n  flex-direction: column;\n  text-align: center;\n  color: #fff;\n`;\n\nconst AddIcon = styled.img`\n  width: 100px;\n  margin: 0 auto 32px auto;\n`;\n\nconst InstructionWrapper = styled.div`\n  font-size: 12px;\n  margin-top: 24px;\n`;\n","import React, { useState, useEffect } from \"react\";\nimport { createGlobalStyle } from \"styled-components\";\n\nimport { Route, HashRouter, Switch, Redirect } from \"react-router-dom\";\nimport { Welcome } from \"./containers/Welcome\";\nimport { Confirm } from \"./containers/Confirm\";\nimport { QR } from \"./containers/QR\";\nimport { PWAPrompt } from \"./components/PWAPrompt\";\nimport { disableBodyScroll } from \"body-scroll-lock\";\n\nfunction App() {\n  const [isPWA, setPWA] = useState(false);\n\n  useEffect(() => {\n    setPWA(\n      window.matchMedia(\"(display-mode: standalone)\").matches ||\n        /\\bmode=standalone\\b/.test(window.location.hash) ||\n        window.location.hostname === \"localhost\"\n    );\n  }, []);\n\n  useEffect(() => {\n    const root = document.querySelector(\"#root\");\n    if (!root) return;\n    disableBodyScroll(root);\n  }, []);\n\n  return (\n    <>\n      <GlobalStyle />\n      {isPWA ? (\n        <HashRouter basename=\"/\">\n          <Switch>\n            <Route exact path=\"/\">\n              <Welcome />\n            </Route>\n            <Route exact path=\"/qr\">\n              <QR />\n            </Route>\n            <Route exact path=\"/confirm\">\n              <Confirm />\n            </Route>\n            <Redirect to=\"/\" />\n          </Switch>\n        </HashRouter>\n      ) : (\n        <PWAPrompt />\n      )}\n    </>\n  );\n}\n\nexport default App;\n\nconst GlobalStyle = createGlobalStyle`\nhtml {\n  width: 100%;\n  height: 100%;\n}\n\nbody {\n  margin: 0;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n    sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  background-color:#12b188;\n  width: 100%;\n  height: 100%;\n}\n\n\n#root {\n  width: 100%;\n  height: 100%;\n}\n\na {\n  text-decoration: none;\n}\n`;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorkerRegistration from \"./serviceWorkerRegistration\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://cra.link/PWA\nserviceWorkerRegistration.register();\n\n"],"sourceRoot":""}